(()=>{function t(t){return null==t?"":String(t).toLowerCase()}function e(t){return null==t?"":String(t)}function n(t){return t?String(t).normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""):""}function i(t){if(!t)return"#000";let e=t.replace("#","");return 3===e.length&&(e=e.split("").map(t=>t+t).join("")),(299*(parseInt(e.substr(0,2),16)||0)+587*(parseInt(e.substr(2,2),16)||0)+114*(parseInt(e.substr(4,2),16)||0))/1e3>128?"#000":"#fff"}function a(t){const e=(t||"").toString().toLowerCase();return"poster"===e||"poster-image"===e||"poster_image"===e?"poster_image":"cover"===e||"cover-image"===e||"cover_image"===e?"cover_image":"still"===e||"still-image"===e||"still_image"===e?"still_image":e}function r(t,e){try{const n=new URL(window.location.href);t?n.searchParams.set("tag-id",t):n.searchParams.delete("tag-id"),"replace"===e?history.replaceState({},"",n.toString()):history.pushState({},"",n.toString())}catch(t){}}function o(t){const e=new Set,n=new Set;return(t||[]).forEach(function(t){if(null==t)return;const i=String(t).trim();i&&(e.add(i),n.add(i.toLowerCase()))}),{ids:e,names:n}}function l(t,e,n,i){const a=t.tags||[];if(!a.length)return!1;const r=i?String(i).trim().toLowerCase():null;for(let t=0;t<a.length;t++){const o=a[t],l=o&&null!=o.id?String(o.id):"",c=o&&null!=o.name?String(o.name).toLowerCase():"";if((!r||l===i||c===r)&&(e.has(l)||n.has(c)))return!0}return!1}function c(c){if(!c||c.__efgInited)return;c.__efgInited=!0,c.id||(c.id="efg-"+Math.random().toString(36).slice(2));const s=window.EventiveBlockData?.eventBucket||"",d=window.EventiveBlockData?.filmSyncEnabled||!1,u=window.EventiveBlockData?.prettyPermalinks||!1,f=window.EventiveBlockData?.filmDetailUrl||"";let m=[];try{m=(c.getAttribute("data-tag-name")||"").split(",").map(t=>t.trim()).filter(Boolean)}catch(t){}let g=[];try{g=(c.getAttribute("data-exclude-tag")||"").split(",").map(t=>t.trim()).filter(Boolean)}catch(t){}const v=c.getAttribute("data-film-id")||"";let h=c.getAttribute("data-image")||"poster";h=a(h);let p=c.getAttribute("data-view")||"grid";const w="true"===c.getAttribute("data-show-events"),y="true"===c.getAttribute("data-show-details"),E="true"===c.getAttribute("data-show-description"),b="true"===c.getAttribute("data-show-tags"),S="true"===c.getAttribute("data-year-round"),L="true"===c.getAttribute("data-search"),_="true"===c.getAttribute("data-show-filter"),A="true"===c.getAttribute("data-show-view-switcher");let C=c.querySelector(".eventive-film-guide-tags-filter");_&&!C&&(C=document.createElement("div"),C.className="eventive-film-guide-tags-filter",c.insertBefore(C,c.firstChild));let k=c.querySelector(".eventive-film-guide-search");if(L&&!k){k=document.createElement("div"),k.className="eventive-film-guide-search";const t=document.createElement("input");t.type="search",t.placeholder="Search films (title, cast, crew)â€¦",t.className="eventive-search-input",k.appendChild(t),C?C.after(k):c.insertBefore(k,c.firstChild)}let q=c.querySelector(".eventive-film-guide-controls");A&&!q&&(q=document.createElement("div"),q.className="eventive-film-guide-controls",q.innerHTML=`\n\t\t\t<label>\n\t\t\t\tView:\n\t\t\t\t<select class="view-selector">\n\t\t\t\t\t<option value="grid" ${"grid"===p?"selected":""}>Grid</option>\n\t\t\t\t\t<option value="list" ${"list"===p?"selected":""}>List</option>\n\t\t\t\t</select>\n\t\t\t</label>\n\t\t\t<label>\n\t\t\t\tImage:\n\t\t\t\t<select class="image-selector">\n\t\t\t\t\t<option value="poster_image" ${"poster_image"===h?"selected":""}>Poster</option>\n\t\t\t\t\t<option value="cover_image" ${"cover_image"===h?"selected":""}>Cover</option>\n\t\t\t\t\t<option value="still_image" ${"still_image"===h?"selected":""}>Still</option>\n\t\t\t\t</select>\n\t\t\t</label>\n\t\t`,k?k.after(q):C?C.after(q):c.insertBefore(q,c.firstChild));let M=c.querySelector(".eventive-film-guide-container");M||(M=document.createElement("div"),M.className="eventive-film-guide-container",c.appendChild(M));let D=M.querySelector(".catalog-film-container.grid"),N=M.querySelector(".catalog-film-container.list");D||(D=document.createElement("div"),D.className="catalog-film-container grid",M.appendChild(D)),N||(N=document.createElement("div"),N.className="catalog-film-container list",M.appendChild(N)),D.style.display="grid"===p?"grid":"none",N.style.display="list"===p?"block":"none";let T=new URLSearchParams(window.location.search).get("tag-id")||"",j="",F=[];const P=o(m),z=o(g);let I=!1;function B(){I||(I=!0,requestAnimationFrame(function(){I=!1,function(){let t=F.slice();if(v&&(t=t.filter(function(t){return String(t.id)===String(v)})),v||!P.ids.size&&!P.names.size||(t=t.filter(function(t){return l(t,P.ids,P.names)})),!v&&T){const e=String(T).trim();t=t.filter(function(t){return l(t,new Set([e]),new Set([e.toLowerCase()]))})}(z.ids.size||z.names.size)&&(t=t.filter(function(t){return!l(t,z.ids,z.names)})),j&&(t=t.filter(function(t){return t._lc_name.indexOf(j)>-1||t._lc_desc.indexOf(j)>-1||t._lc_credits.indexOf(j)>-1})),t.sort(function(t,e){const n=(t.name||"").toLowerCase(),i=(e.name||"").toLowerCase();return n<i?-1:n>i?1:0});const r="list"===p?N||D:D||N;if(!r)return;if(!t.length)return void(r.innerHTML='<div class="catalog-no-films">No films found for the selected criteria.</div>');r.innerHTML="";let o=0;requestAnimationFrame(function l(){const c=document.createDocumentFragment(),s=Math.min(o+20,t.length);for(;o<s;o++){const r=t[o],l=y?r.details&&r.details.runtime||"N/A":null,s=y?r.credits&&r.credits.director||"Unknown":null,m=y?r.details&&r.details.year||"N/A":null,g=y?r.details&&r.details.language||"N/A":null,v=r[a(h)]||r[h]||"default-placeholder.jpg",S=r.short_description||"",L=n(r.name);let _="";_=d?e(f).replace(/\/$/,"")+"/"+L:u?f+"?film-id="+encodeURIComponent(r.id):f+"&film-id="+encodeURIComponent(r.id);let A="";const C=Array.isArray(r.tags)?r.tags:[];if(b&&C&&C.length){const t=new Map;C.forEach(function(e){if(!e)return;const n=null!=e.id?String(e.id):"",i=e.name||e.title||n;i&&t.set(n||i,e)}),A='<div class="catalog-film-tags">'+Array.from(t.values()).map(function(t){const n=i(t.color||"#e0e0e0");return'<span class="catalog-film-tag-pill" style="background-color:'+e(t.color||"#e0e0e0")+";color:"+n+'" data-tag-id="'+e(t.id||t.name)+'">'+e(t.name)+"</span>"}).join("")+"</div>"}const k=document.createElement("div");"list"===p?(k.className="catalog-film-list-item",k.innerHTML='<a href="'+_+'"><img class="catalog-film-image" loading="lazy" decoding="async" src="'+v+'" alt="'+(r.name||"Film")+'"/></a><div class="catalog-film-details"><h2 class="catalog-film-title">'+(r.name||"")+"</h2>"+A+'<span class="catalog-film-description">'+(y?"Directed by: "+s+"<br />"+l+" min | "+m+" | "+g:"")+"</span>"+(E&&S?'<div class="catalog-film-short">'+S+"</div>":"")+(w?'<div class="catalog-film-details-link"><a href="'+_+'">Details & Showtimes</a></div>':"")+"</div>"):(k.className="catalog-film-box",k.setAttribute("role","article"),k.innerHTML='<a href="'+_+'"><img class="catalog-film-image" loading="lazy" decoding="async" src="'+v+'" alt="'+(r.name||"Film")+'"/></a><div class="catalog-film-details"><h3 class="catalog-film-title">'+(r.name||"")+"</h3>"+A+(y?'<span class="catalog-film-description">'+s+"<br />"+l+" min | "+m+" | "+g+"</span>":"")+(E&&S?'<div class="catalog-film-short">'+S+"</div>":"")+(w?'<div class="catalog-film-details-link"><a href="'+_+'">Details & Showtimes</a></div>':"")+"</div>"),c.appendChild(k)}r.appendChild(c),o<t.length&&requestAnimationFrame(l)})}()}))}if(q){const t=q.querySelector(".view-selector"),e=q.querySelector(".image-selector");t&&t.addEventListener("change",function(t){p=t.target.value,D.style.display="grid"===p?"grid":"none",N.style.display="list"===p?"block":"none",B()}),e&&e.addEventListener("change",function(t){h=a(t.target.value),B()})}if(k){const t=k.querySelector(".eventive-search-input");if(t){const e=function(t){let e;return function(){const n=arguments,i=this;clearTimeout(e),e=setTimeout(function(){t.apply(i,n)},150)}}(function(){j=(t.value||"").trim().toLowerCase(),B()});t.addEventListener("input",e),t.addEventListener("change",e),t.addEventListener("keydown",function(t){"Enter"===t.key&&(t.preventDefault(),e())})}}function U(){if(C)try{const t=C.querySelectorAll(".eventive-tag-btn");t.forEach(function(t){t.classList.remove("active")}),t.forEach(function(t){const e=t.getAttribute("data-tag-id");T?e===T&&t.classList.add("active"):e||t.classList.add("active")})}catch(t){}}function H(){if(!window.Eventive){const t="list"===p?N:D;return void(t&&(t.innerHTML='<div class="catalog-error">Eventive API is not available.</div>'))}const n=function(){(function(t,e){const n=t+"::"+(e?"marquee":"all"),i=window.__Eventive_FilmCache;if(i[n])return Promise.resolve(i[n]);if(!window.Eventive)return Promise.reject(new Error("Eventive not ready"));const a={method:"GET",path:"event_buckets/"+encodeURIComponent(t)+"/films",qs:{include:"tags"},authenticatePerson:!1};return e&&(a.qs.marquee=!0),window.Eventive.request(a).then(function(t){const e=t&&t.films||[];return i[n]=e,e})})(s,S).then(function(n){F=function(e){return(e||[]).map(function(e){if(!e)return e;const n=String(e.description||e.short_description||"");let i="";if(e.credits&&"object"==typeof e.credits)try{i=Object.values(e.credits).flat().join(" ")}catch(t){i=Object.values(e.credits).join(" ")}return Object.assign({},e,{_lc_name:t(e.name),_lc_desc:t(n),_lc_credits:t(i)})})}(n),function(t){if(!C)return;let n=t.slice();v||!P.ids.size&&!P.names.size||(n=n.filter(function(t){return l(t,P.ids,P.names)})),(z.ids.size||z.names.size)&&(n=n.filter(function(t){return!l(t,z.ids,z.names)}));const a=function(t){const e=new Map;return(t||[]).forEach(function(t){(Array.isArray(t.tags)?t.tags:[]).forEach(function(t){if(!t)return;const n=null!=t.id?String(t.id):"",i=t.name||t.title||t.label||(n?"#"+n:"");if(!n&&!i)return;const a=e.get(n||i)||{id:n,name:i,color:t.color||"#e0e0e0",count:0};a.count+=1,e.set(n||i,a)})}),Array.from(e.values())}(n);if(!a.length)return void(C.innerHTML="");const r=function(){try{const t=new URL(window.location.href);return t.searchParams.delete("tag-id"),t.toString()}catch(t){return"#"}}();let o="";o+='<div class="eventive-tags-list">',o+='<button class="eventive-tag-btn" data-tag-id=""><a class="external-tag-filter" data-tag-id="" href="'+r+'">All</a></button>',a.sort(function(t,e){return t.name.toLowerCase()<e.name.toLowerCase()?-1:1}),o+=a.map(function(t){const n=i(t.color||"#e0e0e0"),a=function(){try{const e=new URL(r);return e.searchParams.set("tag-id",t.id||t.name),e.toString()}catch(t){return"#"}}();return'<button class="eventive-tag-btn" style="background-color:'+e(t.color||"#e0e0e0")+";color:"+n+'" data-tag-id="'+e(t.id||t.name)+'"><a class="external-tag-filter" data-tag-id="'+e(t.id||t.name)+'" href="'+a+'">'+e(t.name)+"</a></button>"}).join(""),o+="</div>",C.innerHTML=o,U()}(F),B()}).catch(function(){const t="list"===p?N:D;t&&(t.innerHTML='<div class="catalog-error">Failed to load films.</div>')})};let a=!1;try{window.Eventive&&"function"==typeof window.Eventive.ready&&(window.Eventive.ready(n),a=!0)}catch(t){}if(!a)try{window.Eventive&&window.Eventive.on&&"function"==typeof window.Eventive.on&&(window.Eventive.on("ready",n),a=!0)}catch(t){}if(!a){let t=0;!function e(){window.Eventive&&"function"==typeof window.Eventive.request||++t>60?n():setTimeout(e,50)}()}}document.addEventListener("eventive:setActiveTag",function(t){try{const e=t&&t.detail&&(void 0!==t.detail.tagId?t.detail.tagId:t.detail);if(void 0===e)return;T=String(e||""),r(T,"replace"),U(),B()}catch(t){}}),C&&C.addEventListener("click",function(t){const e=t.target&&t.target.closest?t.target.closest("a.external-tag-filter"):null;if(!e)return;if(t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||"_blank"===e.target)return;t.preventDefault(),t.stopPropagation();const n=e.getAttribute("data-tag-id")||"";T=String(n),r(T,"replace"),U(),B()},!0),window.addEventListener("popstate",function(){try{const t=new URL(window.location.href).searchParams.get("tag-id")||"";T=t,U(),B()}catch(t){}}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",H,{once:!0}):H()}function s(){const t=document.querySelectorAll(".wp-block-eventive-film-guide");t&&t.length&&t.forEach(function(t){if(!t.getAttribute)return;const e=t.parentElement&&t.parentElement.closest&&t.parentElement.closest(".wp-block-eventive-film-guide");e&&e!==t||c(t)})}window.__Eventive_FilmCache=window.__Eventive_FilmCache||{},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",s,{once:!0}):s(),window.jQuery&&window.elementorFrontend&&window.jQuery(window).on("elementor/frontend/init",function(){try{window.elementorFrontend.hooks.addAction("frontend/element_ready/shortcode.default",function(t){if(t&&t[0]){const e=t[0].querySelectorAll(".wp-block-eventive-film-guide");e&&e.length&&e.forEach(c)}})}catch(t){}})})();