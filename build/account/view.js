(()=>{"use strict";const e=window.wp.element,n=window.ReactJSXRuntime;function o({children:o}){const[t,i]=(0,e.useState)(!1),[c,r]=(0,e.useState)(!0);return(0,e.useEffect)(()=>{const e=()=>{if(window.Eventive&&"function"==typeof window.Eventive.isLoggedIn)try{const e=window.Eventive.isLoggedIn();i(e)}catch(e){console.error("[eventive-account] login check error",e),i(!1)}finally{r(!1)}};if(!window.Eventive||!window.Eventive.on)return r(!1),void i(!1);window.Eventive._ready||window.Eventive.ready?e():window.Eventive.on("ready",e);try{window.Eventive.on("login",()=>{i(!0)}),window.Eventive.on("logout",()=>{i(!1)})}catch(e){}},[]),c?(0,n.jsx)("div",{className:"eventive-account-container",children:(0,n.jsx)("p",{className:"eventive-loading",children:"Loading..."})}):t?(0,n.jsxs)("div",{className:"eventive-account-container",children:[(0,n.jsx)("div",{className:"account-actions",children:(0,n.jsx)("a",{href:"#",onClick:async e=>{if(e.preventDefault(),"function"==typeof window.handleLogout)try{return void window.handleLogout()}catch(e){console.error("handleLogout error:",e)}try{["eventivePersonToken","eventiveAppPersonToken","eventive_token","eventive_person_token"].forEach(e=>{try{localStorage.removeItem(e)}catch(e){}});try{sessionStorage.clear()}catch(e){}if(document.cookie="eventive-personState=; path=/; max-age=0",window.Eventive&&window.Eventive.logout)try{await window.Eventive.logout()}catch(e){console.error("Eventive.logout() failed:",e)}if(window.Eventive&&window.Eventive.request)try{await window.Eventive.request({method:"POST",path:"people/logout",authenticatePerson:!0})}catch(e){}window.location.reload()}catch(e){console.error("Unexpected logout error:",e),window.location.reload()}},className:"eventive-logout-link",children:"Log out"})}),o]}):(0,n.jsx)("div",{className:"eventive-account-container",children:(0,n.jsx)("div",{className:"eventive-notice",children:(0,n.jsx)("p",{children:"You are not logged in. Please log in to view your account."})})})}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".wp-block-eventive-account").forEach(t=>{if(t.__evtInited)return;t.__evtInited=!0;const i=t.innerHTML;document.createElement("div").innerHTML=i,(0,e.createRoot)(t).render((0,n.jsx)(o,{children:(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:i}})}))})})})();